![](bendit_demo.gif)

# Problem Statement
The COVID-19 outbreak has put a halt to the normal fitness schedules of many Americans, leading to an increase in the popularity of online fitness regiments. Even before COVID-19, a 2020 [study](https://www.businesswire.com/news/home/20200212005665/en/4708176/Global-Interactive-Fitness-Market-2020-2024-Growing-Awareness) concluded that the online fitness industry was expected to grow by $5.44 billion from 2020-2024. The majority of thse classes are available in three categories: recorded, large-scale live, and small-scale live, with each format having its own strengths and drawbacks. For online yoga classes in particular, there are few options that balance the affordablility of large classes while maintaining the instructional capabilities that are afforded by a small, intimate class. My goal with this project was to build a platform that had the potential to bridge such a gap.  

# Executive Summary
This project, which I call "Bendit," shows great potential for the use of cutting edge machine learning in improving the online fitness experience of beginner yoga students. First, Bendit takes in live video feed and uses Google's [Posenet](https://github.com/tensorflow/tfjs-models/tree/master/posenet) model to map keypoints to the user's body in real-time. It then feeds the resul into a pre-trained classification model that has been re-trained on yoga poses by via transfer learning. The resulting model, served in javascript, classifies six different yoga poses and gives an a confidence score for each prediction.   

The first hurdle to overcome in the construction of this platform was the use of a pose model. There were a few different pose models available, but Google Posenet seemed to have the quickest inference time, which was a capability that I needed for real-time classification. The caveat with Posenet is that I could not find a stable version that was ported to python, and at the current time (May 2020)Posenet is only available in TFlite and tensorflow.js, meaning that I would either have to try to train a classification model with outputs from a Raspberry Pi, or piece together enough javascript to create Bendit on a front-end framework that I was not familiar with. After a few days of experimentation, I chose the latter.

In order to create a second javascript model to classify the yoga poses themselves, I used Google's Teachable Machine [library](https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries), allowing me to utilize transfer learning on a pre-trained Mobilenet model. The outputs of the new model were seven different yoga poses for which I had collected data: boat pose, warrior pose, low-lunge pose, child's pose, cobra pose, plank pose, and downward dog. I arbitrarily chose these particular poses because they seemed amateur enough for me to be able to personally demonstrate while demoing Bendit, while still necessitating enough bodily complexity that it would test if this product was at all feasible. This particular model was trained on a database of about 150 images per pose, all downloaded from Google, and was able to accurately classify about 87% of the yoga poses from static images. The model struggled the most on the few poses that are similarly executed: child's pose, plank pose, and cobra pose, where it scored about 85% for each respective class. For low-lunge pose, warrior pose, and downward dog, the validation accuracy hovered at around 97%.  

Some of the javascript code in the model.js file was taken directly from the Teachable Machine library documentation, and I do not claim it as original. Even though I am not a javascript coder, I did, however, figure out how to change enough of it to suit the demonstration of Bendit. For instance, it dynamically updates the web page with the top scoring pose classification based on the webcam input and a pre-determined minimum confidence threshold, in lieu of which it outputs a "No Pose" message. I built the HTML with Bootstrap, but piecing the HTML and javascript models together, adding interactivity, as well as adding CSS styling, were wholly my ow doing, and each had a decent learning curve after coming from a solely python background.  

There are, as with any amateur coding escapade, a number of issues with the project, many of which will be rectified with continued development. I have yet to find a way to turn the class prediction label into a rolling average, or to (ironically) slow down its inference time. As of right now, it frantically jumps between pose classifications, while I would like it to more smoothly render its prediction. In the future, I will code it to output a pose prediction only if the position has been held for a minimum amount of time.  

# Conclusions & Further Development 
The potential for a platform that adds interactive features to online yoga classes is exciting. If this platform were integrated into large-scale online classes, it could augment the experience in a few different ways. Bendit could [drive program attendance](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5008041/) by tracking an individual's own performance and add it to an online profile for comparison and competition between users, for example scoring and aggregating how accurate and how lengthy a user's poses were during a given session. It could also give instructors of large-scale classes real-time insight as to where they should be directing their resources by focusing said instructors to the students that have the highest deviation from perfect form.  

Going forward, I would like to experiment with different pose models. It wasn't until after almost finishing the project that I realized much of the yoga poses I was looking to classify were actually static. I figured that using Google Posenet would be the best template because it had the fastest inference time, but in the future I would like to use slower, more accurate pose models, and see if the accuracy/speed trade off is tolerable in this particular use case. 
